jobs:
  include:
    - stage: Tests
      name: Tests
      language: elixir
      elixir: '1.9.1'
      otp_release: '22.0.7'
      services:
        - postgresql
        - redis-server
      cache:
        directories:
          - deps
          - _build
      script: mix test

    - name: Build
      language: minimal
      script: docker build -t us.gcr.io/cloud-57/budget-api:latest .

    - stage: Deploy
      script: mix test
